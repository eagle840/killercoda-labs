# ZAP


https://www.zaproxy.org/docs/docker/about/

Dos's covering the types of scan: https://www.zaproxy.org/docs/docker/


# with webswing

`docker run -u zap -p 8080:8080 -p 8090:8090 -i ghcr.io/zaproxy/zaproxy:stable zap-webswing.sh`{{execute}}


{{TRAFFIC_HOST1_8080}}/zap

once open

Tools>options>API  note api key value

- Add address' to define what others can access (localhost only by default)

## Modes

- safe
- protected
- standard
- ATTACK


## Window Layout

```
##################################
# Tree window # Workspace window #
##################################
#     Information window         #
##################################

```

## Wiki/API

once the proxy is setup, a DNS host ZAP is added  :http://ZAP

ajaxsider => ajax syider
ascan     => active scan
context   => contexts
pscan     => passive scan
spider    => regular spider
reports   => reports


## JuiceShop

In the 'Workspace window', click automatic and enter `https://juice-shop.herokuapp.com/`{{copy}}  and then click Attach.

In the 'Workspace window', click automatic and enter `http://localhost:3000`{{copy}}  and then click Attach.



You can review the `information window` Alerts.

## Setting up SSL

In ZAP  settings> Dynamic SSL save the SSL
In Firesfox   Settings> Privacy $ Security > Certicates > view > import (check thrust websites)
  - set proxy to 127.0.0.1:8080 innc https and SOCKS

## Packaged Scans

|     | spider | AJAX Spider | Passive  | ATTACK |
|-----|--------|-------------|----------|--------|
|Basline| X | X | X |   |
|Full   | X | X | X | X |
|API    |   |   |   | X |

## workflow

Context => spider => ascan => reports

API for status  100 = completed scan

## Addons

Also know as market place

www.zaproxy.org/addons


# Access the API from outside of the docker container

WIP **Isn't this in step 4?**

https://www.zaproxy.org/docs/docker/about/#accessing-the-api-from-outside-of-the-docker-container

Read and comsume this: https://www.zaproxy.org/docs/docker/about/

`docker ps`{{exec}}

what about docker pull ghcr.io/zaproxy/zaproxy:bare

`docker run -u zap -p 8080:8080 -i zaproxy/zap-stable zap.sh -daemon -port 8080 -host 0.0.0.0 -config api.disablekey=true -config api.addrs.addr.name=.* -config api.addrs.addr.regex=true`{{exec}}


Args for starting ZAP
  -config k=v
  -daemon
  -host
  -port
  -new session # with name
  -session  # start session name

`curl    http://localhost:8080/JSON/core/view/version`{{exec}}


`touch scan_request.json`{{exec}}

`nano scan_request.json`{{exec}}

```
{
  "url": "http://example.com",
  "context": "Default Context",
  "recurse": "true",
  "inScopeOnly": "false"
}
```
need to add context: "Default Context"

WIP: list contexts

Documentation? https://www.zaproxy.org/docs/api/#api-catalogue

for the following scan: https://www.zaproxy.org/docs/api/?shell#ascanactionscan

`curl -X POST http://localhost:8080/JSON/ascan/action/scan/ -d @scan_request.json -H "Content-Type: application/json"`{{exec}}



To start a scan using OWASP ZAP in daemon mode, you can use the ZAP API. Hereâ€™s a step-by-step guide:

1. **Start OWASP ZAP**: You've already done this with your Docker command.

2. **Access the ZAP API**: You can interact with the ZAP API using HTTP requests. Since you've disabled the API key, you can directly send requests to `http://localhost:8080`.

3. **Spider the target URL**: This will crawl the target URL to discover all the links. Use the following API call:
    ```bash
    curl "http://localhost:8080/JSON/spider/action/scan/?url=http://example.com"
    ```

4. **Check the spider status**: Ensure the spidering process is complete before starting the active scan:
    ```bash
    curl "http://localhost:8080/JSON/spider/view/status/"
    ```

5. **Start the active scan**: Once spidering is complete, initiate the active scan:
    ```bash
    curl "http://localhost:8080/JSON/ascan/action/scan/?url=http://example.com"
    ```

6. **Monitor the scan progress**: You can check the status of the active scan:
    ```bash
    curl "http://localhost:8080/JSON/ascan/view/status/"
    ```

7. **Retrieve the scan results**: After the scan is complete, you can get the results:
    ```bash
    curl "http://localhost:8080/JSON/core/view/alerts/?baseurl=http://example.com" | jq
    ```

For more detailed information, you can refer to the ZAP API documentation[1](https://www.zaproxy.org/docs/desktop/start/features/api/).

Is there a specific type of scan or target you're working with?


To save the HTML report to a file and serve it using Python, you can follow these steps:

### Step 1: Save the HTML Report to a File
Use the following `curl` command to save the HTML report generated by OWASP ZAP to a file named `zap_report.html`:

```bash
curl "http://localhost:8080/OTHER/core/other/htmlreport/" -o zap_report.html
```

`curl "http://localhost:8080/OTHER/core/other/pdfreport/"`

### Step 2: Serve the HTML Document Using Python
You can use Python's built-in HTTP server to serve the HTML document. Here is a Python script to do that:

```python
import http.server
import socketserver

PORT = 8000
Handler = http.server.SimpleHTTPRequestHandler

with socketserver.TCPServer(("", PORT), Handler) as httpd:
    print(f"Serving at port {PORT}")
    httpd.serve_forever()
```

Save this script to a file, for example, `serve_html.py`, and run it using Python:

```bash
python serve_html.py
```

This will start a local server on port 8000. You can then access your HTML report by navigating to `http://localhost:8000/zap_report.html` in your web browser.

Let me know if you need any further assistance!
